<!DOCTYPE html>
<lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precision Engineering</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"> -->

    <!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://github.com/downloads/lafeber/world-flags-sprite/flags32.css">

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->

    <!-- jquery 3.5.1 -->
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

    <!-- Bootstrap core CSS -->
    <!-- <link href="dist/css/bootstrap.min.css" rel="stylesheet"> -->

    <!-- Boostrap 4.6.1 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

    <!-- Select2 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>

    <!-- DataTables test -->
    <!-- <link rel="stylesheet" href="plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
    <link rel="stylesheet" href="plugins/datatables-buttons/css/buttons.bootstrap4.min.css"> -->

    <!-- DataTables Responsive -->
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css">
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>

    <style>
        th {
            font-size: 12px;
        }
        
        td {
            font-size: 11px;
        }
    </style>

    </head>

    <body>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">

                    <div class="row py-5">
                        <div class="col-md-2"> <img src="images/logo_precision.jpg" width="166" height="75" alt="" /></div>
                        <div class="col-md-2">
                            <div class="form-group row">
                                <label for="full_name" class="col-md-6 col-form-label text-md-left">เขตการขาย :</label>
                                <div class="col-md-6">
                                    <select class="form-control" name="SaleRep" id="SaleRep">
                                </select>
                                    <button id="generate" class="btn btn-primary">Generate</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group row">
                                <label for="full_name" class="col-md-3 col-form-label text-md-left">พนักงานขาย :</label>
                                <div class="col-md-9">
                                    <input type="text" class="form-control" id="sales_name" name="sales_name" disabled>
                                    <!-- <button id="generate" class="btn btn-primary">Generate</button> -->
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-left">รหัสลูกค้า :</label>
                                <div class="col-md-8">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>
                        </div>
                    </div>


                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Customer</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="order-tab" data-toggle="tab" href="#order" role="tab" aria-controls="order" aria-selected="false">Order</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <p></p>

                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">รหัสร้านค้า</label>
                                <div class="col-md-4">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">ชื่อร้านค้า</label>
                                <div class="col-md-4">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">ที่อยู่</label>
                                <div class="col-md-4">
                                    <textarea id="full_name" class="form-control" name="full-name" rows="3"></textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">Tel.</label>
                                <div class="col-md-4">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">Mobile</label>
                                <div class="col-md-4">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="full_name" class="col-md-4 col-form-label text-md-right">ขนส่งที่ใช้</label>
                                <div class="col-md-4">
                                    <input type="text" id="full_name" class="form-control" name="full-name">
                                </div>
                            </div>


                        </div>

                        <div class="tab-pane fade" id="order" role="tabpanel" aria-labelledby="order-tab">

                            <div class="row">
                                <div class="col-6"></div>
                                <div class="col-6">
                                    <a href="javascript:void(0)" class="btn btn-primary float-right add-model"><i class="fas fa-plus"></i>Add Item </a>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">

                                    <div class="card">

                                        <div class="card-header">
                                            <h6 class="card-title">ตารางสั่งสินค้า</h6>
                                        </div>
                                        <!-- /.card-header -->

                                        <div class="card-body">
                                            <!-- <a href="javascript:void(0)" class="btn btn-primary float-right add-model">Add Item </a> -->
                                            <!-- <button type="button" class="btn btn-primary float-right"><i class="fas fa-plus"></i> Add item</button> -->
                                            <table id="example" class="table responsive table-striped table-bordered" style="width:100%">

                                                <thead>

                                                    <tr>
                                                        <th scope="col" rowspan="2">#</th>
                                                        <th scope="col" rowspan="2">ประเภทสินค้า</th>
                                                        <th scope="col" rowspan="2">รหัสสินค้า</th>
                                                        <th scope="col" rowspan="2">ชื่อ/ชนิดสินค้า</th>
                                                        <th scope="col" colspan="3">ส่วนลด%</th>
                                                        <th scope="col" rowspan="2">เครดิต</th>
                                                        <th scope="col" rowspan="2">ลดเงินสด/เครดิต</th>
                                                        <th scope="col" colspan="2">ส่วนลดเป้า</th>
                                                        <th scope="col" colspan="6">จำนวนซื้อ+แถม</th>
                                                        <th scope="col" rowspan="2">วันที่ต้องการสินค้า</th>
                                                        <th scope="col" rowspan="2">หมายเหตุ</th>
                                                        <th scope="col" rowspan="2">Action</th>
                                                    </tr>
                                                    <tr>
                                                        <th>ลดสินค้า%</th>
                                                        <th>ลดจำนวน%</th>
                                                        <th>ลดพิเศษ%</th>
                                                        <th>เร่งเบิก</th>
                                                        <th>REB</th>
                                                        <th>จำนวน (5G)</th>
                                                        <th>ถัง S (2.5G)</th>
                                                        <th>ถัง S (2.5G) free</th>
                                                        <th>กล. (1G)</th>
                                                        <th>กล. (1G) free</th>
                                                        <th>กป.(1/4)</th>
                                                    </tr>
                                                </thead>
                                                <tfoot>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>ประเภทสินค้า</th>
                                                        <th>รหัสสินค้า</th>
                                                        <th>ชื่อ/ชนิดสินค้า</th>
                                                        <th>ลดสินค้า%</th>
                                                        <th>ลดจำนวน%</th>
                                                        <th>ลดพิเศษ%</th>
                                                        <th>เครดิต</th>
                                                        <th>ลดเงินสด/เครดิต</th>
                                                        <th>เร่งเบิก</th>
                                                        <th>REB</th>
                                                        <th>จำนวน (5G)</th>
                                                        <th>ถัง S (2.5G)</th>
                                                        <th>ถัง S (2.5G) free</th>
                                                        <th>กล. (1G)</th>
                                                        <th>กล. (1G) free</th>
                                                        <th>กป.(1/4)</th>
                                                        <th>วันที่ต้องการสินค้า</th>
                                                        <th>หมายเหตุ</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                        <!-- /.card-body -->


                                    </div>
                                    <!-- /.card -->

                                </div>
                                <!-- /.col -->
                            </div>
                            <!-- /.row -->

                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>


    </body>

    <!-- add-modal -->
    <div class="modal fade" id="add-modal" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="userCrudModal"></h4>
                </div>
                <div class="modal-body">
                    <form id="add-form" name="add-form" class="form-horizontal">
                        <input type="hidden" class="form-control" id="mode" name="mode" value="add">
                        <div class="row">
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">ประเภทสินค้า</label>
                                    <div class="col-sm-12">
                                        <select id="product_category" name="product_category" class="form-control" required="">
                                    <option value="WT">WT</option>
                                    <option value="WF">WF</option>
                                    <option value="WW">WW</option>
                                </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">รหัสสินค้า</label>
                                    <div class="col-sm-12">
                                        <select id="product_code" name="product_code" class="form-control" required="">
                                        <option value="WT-001">WT-001</option>
                                        <option value="WC-301">WC-301</option>
                                        <option value="WC-302">WC-302</option>
                                    </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">ชื่อ/ชนิดสินค้า</label>
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="product_name" name="product_name" placeholder="Enter..." value="" required="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ส่วนลด%</label>
                                    <div class="row">
                                        <div class="col-sm-4" style="padding-left: 30px;">
                                            <input type="text" class="form-control" id="discount_percent1" name="discount_percent1" placeholder="สินค้า" value="" required="">
                                        </div>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="discount_percent2" name="discount_percent2" placeholder="จำนวน" value="" required="">
                                        </div>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="discount_percent3" name="discount_percent3" placeholder="พิเศษ" value="" required="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">เครดิต</label>
                                    <div class="col-sm-12">
                                        <select id="credit" name="credit" class="form-control" required="">
                                    <option value="30">30</option>
                                    <option value="60">60</option>
                                    <option value="90">90</option>
                                    <option value="120">120</option>
                                </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ลดเงินสด/เครดิต</label>
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="cash_credit" name="cash_credit" placeholder="Enter..." value="" required="">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ส่วนลดเป้า</label>
                                    <div class="row">
                                        <div class="col-sm-6" style="padding-left: 30px;">
                                            <input type="text" class="form-control" id="withdraw" name="withdraw" placeholder="เร่งเบิก" value="" required="">
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class="form-control" id="REB" name="REB" placeholder="REB" value="" required="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-6 control-label">จำนวนซื้อ+แถม</label>
                            <div class="row">
                                <div class="col-sm-4" style="padding-left: 30px;">
                                    <input type="text" class="form-control" id="qty_5g" name="qty_5g" placeholder="ถัง (5G)" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_25g" name="qty_25g" placeholder="ถังS (2.5G) ซื้อ" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_25gfree" name="qty_25gfree" placeholder="ถังS (2.5G) แถม" value="" required="">
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4" style="padding-left: 30px;">
                                    <input type="text" class="form-control" id="qty_1g" name="qty_1g" placeholder="กล.(1G)/ชุดซื้อ" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_1gfree" name="qty_1gfree" placeholder="กล.(1G)/ชุดแถม" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_14" name="qty_14" placeholder="กป.(1/4G)/ชุดกป." value="" required="">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-6 control-label">วันที่ต้องการสินค้า</label>
                            <div class="col-sm-12">
                                <input type="text" class="form-control" id="required_date" name="required_date" placeholder="Enter Product name" value="" required="">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-6 control-label">หมายเหตุ</label>
                            <div class="col-sm-12">
                                <textarea class="form-control" rows="3" id="comment" name="comment"></textarea>
                            </div>
                        </div>
                        <!-- <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" class="btn btn-primary" id="btn-save" value="create">Save changes
                        </button>
                        </div> -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" id="btn-save" value="create">Save changes
                    <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                </div>
            </div>
        </div>
    </div>

    <!-- edit-modal -->
    <div class="modal fade" id="edit-modal" aria-hidden="true">
        <!-- <div class="modal-dialog" role="document"> -->
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="editModalLabel">Edit Item</h4>
                </div>
                <div class="modal-body">
                    <form id="update-form" name="update-form" class="form-horizontal">
                        <input type="hidden" name="run_id" id="run_id" />
                        <input type="hidden" class="form-control" id="mode" name="mode" value="update">
                        <div class="row">
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">ประเภทสินค้า</label>
                                    <div class="col-sm-12">
                                        <select id="product_category" name="product_category" class="form-control" required="">
                                            <option>----------Test-------------</option>
                                </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">รหัสสินค้า</label>
                                    <div class="col-sm-12">
                                        <select id="product_code" name="product_code" class="form-control" required="">
                                    </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="name" class="col-sm-6 control-label">ชื่อ/ชนิดสินค้า</label>
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="product_name" name="product_name" placeholder="Enter..." value="" required="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ส่วนลด%</label>
                                    <div class="row">
                                        <div class="col-sm-4" style="padding-left: 30px;">
                                            <input type="text" class="form-control" id="discount_percent1" name="discount_percent1" placeholder="สินค้า" value="" required="">
                                        </div>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="discount_percent2" name="discount_percent2" placeholder="จำนวน" value="" required="">
                                        </div>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="discount_percent3" name="discount_percent3" placeholder="พิเศษ" value="" required="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">เครดิต</label>
                                    <div class="col-sm-12">
                                        <select id="credit" name="credit" class="form-control" required="">
                                    <option value="30">30</option>
                                    <option value="60">60</option>
                                    <option value="90">90</option>
                                    <option value="120">120</option>
                                </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ลดเงินสด/เครดิต</label>
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control" id="cash_credit" name="cash_credit" placeholder="Enter..." value="" required="">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group">
                                    <label class="col-sm-12 control-label">ส่วนลดเป้า</label>
                                    <div class="row">
                                        <div class="col-sm-6" style="padding-left: 30px;">
                                            <input type="text" class="form-control" id="withdraw" name="withdraw" placeholder="เร่งเบิก" value="" required="">
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" class="form-control" id="REB" name="REB" placeholder="REB" value="" required="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-6 control-label">จำนวนซื้อ+แถม</label>
                            <div class="row">
                                <div class="col-sm-4" style="padding-left: 30px;">
                                    <input type="text" class="form-control" id="qty_5g" name="qty_5g" placeholder="ถัง (5G)" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_25g" name="qty_25g" placeholder="ถังS (2.5G) ซื้อ" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_25gfree" name="qty_25gfree" placeholder="ถังS (2.5G) แถม" value="" required="">
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-4" style="padding-left: 30px;">
                                    <input type="text" class="form-control" id="qty_1g" name="qty_1g" placeholder="กล.(1G)/ชุดซื้อ" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_1gfree" name="qty_1gfree" placeholder="กล.(1G)/ชุดแถม" value="" required="">
                                </div>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="qty_14" name="qty_14" placeholder="กป.(1/4G)/ชุดกป." value="" required="">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-6 control-label">วันที่ต้องการสินค้า</label>
                            <div class="col-sm-12">
                                <input type="text" class="form-control" id="required_date" name="required_date" placeholder="Enter Product name" value="" required="">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-6 control-label">หมายเหตุ</label>
                            <div class="col-sm-12">
                                <textarea class="form-control" rows="3" id="comment" name="comment"></textarea>
                            </div>
                        </div>
                        <!-- <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" class="btn btn-primary" id="btn-save" value="create">Save changes
                        </button>
                        </div> -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" id="btn-save" value="create">Save changes
                    <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                </div>
            </div>
        </div>
    </div>

    <script>
        var table;
        var crud_mode = 0;
        var d;
        var row;

        $(document).ready(function() {
            $('#example').DataTable({

                //responsive: true,

                ajax: '../ajax/data/objects_salary.txt',
                columns: [{
                    data: 'run_id',
                }, {
                    data: 'product_category',
                }, {
                    data: 'product_code',
                }, {
                    data: 'product_name',
                }, {
                    data: 'discount_percent1',
                }, {
                    data: 'discount_percent2',
                }, {
                    data: 'discount_percent3',
                }, {
                    data: 'credit',
                }, {
                    data: 'cash_credit',
                }, {
                    data: 'withdraw',
                }, {
                    data: 'REB',
                }, {
                    data: 'qty_5g',
                }, {
                    data: 'qty_25g',
                }, {
                    data: 'qty_25gfree',
                }, {
                    data: 'qty_1g',
                }, {
                    data: 'qty_1gfree',
                }, {
                    data: 'qty_14',
                }, {
                    data: 'required_date',
                }, {
                    data: 'comment',
                }, {
                    data: null,
                    render: function(data, type, row) {
                        //return '<button class="btn btn-primary float-right btn-edit" data-id="' + data + '">Edit</button><button class="btn btn-danger float-left btn-delete" data-id="' + data + '">Delete</button>';
                        // return '<button class="btn btn-primary float-right btn-edit" data-id="' + row.run_id + '"><i class="fas fa-edit"></i></button><button class="btn btn-warning float-right btn-delete" data-id="' + row.run_id + '">Delete</button>'
                        return '<div><a href="javascript:void(0)" class="btn-edit" data-id="' + row.run_id + '"><i class="fas fa-edit"></i></a> <a href="javascript:void(0)" class="btn-delete" data-id="' + row.run_id + '"><i class="fas fa-trash"></i></a></div>'
                    }
                }]
            });

            //table = $("#usersListTable").DataTable();
            table = $("#example").DataTable();
        });

        $('body').on('click', '.add-model', function() {
            $('#add-modal').modal('show');
            $('.modal-title').text('Add Item'); // Set Title to Bootstrap modal title
            // var id = $(this).data('id');
            // alert(id);
            // return false;
        });

        // add form submit
        $("#add-form").submit(function(e) {
            e.preventDefault();

            var today = new Date();
            var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
            var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
            var dateTime = date + 'T' + time;

            table.rows
                .add([{
                    run_id: 33,
                    product_category: $('#add-form #product_category').val(),
                    product_code: $('#add-form #product_code').val(),
                    product_name: $('#add-form #product_name').val(),
                    discount_percent1: $('#add-form #discount_percent1').val(),
                    discount_percent2: $('#add-form #discount_percent2').val(),
                    discount_percent3: $('#add-form #discount_percent3').val(),
                    credit: $('#add-form #credit').val(),
                    cash_credit: $('#add-form #cash_credit').val(),
                    withdraw: $('#add-form #withdraw').val(),
                    REB: $('#add-form #REB').val(),
                    qty_5g: $('#add-form #qty_5g').val(),
                    qty_25g: $('#add-form #qty_25g').val(),
                    qty_25gfree: $('#add-form #qty_25gfree').val(),
                    qty_1g: $('#add-form #qty_1g').val(),
                    qty_1gfree: $('#add-form #qty_1gfree').val(),
                    qty_14: $('#add-form #qty_14').val(),
                    required_date: dateTime,
                    comment: $('#add-form #comment').val(),
                }, ])
                .draw();

            $("#add-modal").modal("hide");
            $("#add-form").trigger("reset");

        });

        $('body').on('click', '.btn-edit', function() {
            crud_mode = 1;
        });


        $('body').on('click', 'tr', function() {

            if (crud_mode == 0) {
                row = this;
                d = table.row(row).data();
                d.run_id = '44';

                table
                    .row(this)
                    .data(d)
                    .draw();
            } else if (crud_mode == 1) {
                row = this;
                d = table.row(row).data();

                $('#run_id').val(d.run_id);
                $('#update-form #product_category').val(d.product_category);
                $('#update-form #product_code').val(d.product_code);
                $('#update-form #product_name').val(d.product_name);
                $('#update-form #discount_percent1').val(d.discount_percent1);
                $('#update-form #discount_percent2').val(d.discount_percent2);
                $('#update-form #discount_percent3').val(d.discount_percent2);
                $('#update-form #credit').val(d.credit);
                $('#update-form #cash_credit').val(d.cash_credit);
                $('#update-form #withdraw').val(d.withdraw);
                $('#update-form #REB').val(d.REB);
                $('#update-form #qty_5g').val(d.qty_5g);
                $('#update-form #qty_25g').val(d.qty_25g);
                $('#update-form #qty_25gfree').val(d.qty_25gfree);
                $('#update-form #qty_1g').val(d.qty_1g);
                $('#update-form #qty_1gfree').val(d.qty_1gfree);
                $('#update-form #qty_14').val(d.qty_14);
                $('#update-form #required_date').val(d.required_date);
                $('#update-form #comment').val(d.comment);


                $('#edit-modal').modal('show');
                $('.modal-title').text('Edit Item'); // Set Title to Bootstrap modal title
                crud_mode = 0;
            } else if (crud_mode == 2) {
                //table.row('.selected').remove().draw( false );
                table.row(this).remove().draw(false);
                crud_mode = 0;
            }

            //console.log( table.row( this ).data() );
        });

        $('#update-form').submit(function(e) {
            e.preventDefault();

            d.product_category = $('#update-form #product_category').val();
            d.product_code = $('#update-form #product_code').val();
            d.product_name = $('#update-form #product_name').val();
            d.discount_percent1 = $('#update-form #discount_percent1').val();
            d.discount_percent2 = $('#update-form #discount_percent2').val();
            d.discount_percent2 = $('#update-form #discount_percent3').val();
            d.credit = $('#update-form #credit').val();
            d.cash_credit = $('#update-form #cash_credit').val();
            d.withdraw = $('#update-form #withdraw').val();
            d.REB = $('#update-form #REB').val();
            d.qty_5g = $('#update-form #qty_5g').val();
            d.qty_25g = $('#update-form #qty_25g').val();
            d.qty_25gfree = $('#update-form #qty_25gfree').val();
            d.qty_1g = $('#update-form #qty_1g').val();
            d.qty_1gfree = $('#update-form #qty_1gfree').val();
            d.qty_14 = $('#update-form #qty_14').val();
            d.required_date = $('#update-form #required_date').val();
            d.comment = $('#update-form #comment').val();

            table
                .row(row)
                .data(d)
                .draw();

            $('#edit-modal').modal('hide');
            $('#update-form').trigger("reset");
            crud_mode = 0;
        });

        /* DELETE FUNCTION */
        $("body").on("click", ".btn-delete", function() {
            if (confirm("Are You sure want to delete !")) {
                crud_mode = 2;
            }
        });

        // เลือกเขตการขาย พนักงานขาย
        $('#generate').click(function() {

            fetch('../ajax/data/SaleRep.txt')
                .then(function(response) {
                    return response.text();
                })
                .then(function(data) {

                    //var values = ["dog", "cat", "parrot", "rabbit"];

                    var select = $("#SaleRep");
                    var values = data.trim().split(/\r?\n|\r/);


                    values.forEach(function(row, row_index) {
                        var table_columns = '';
                        var columns = row.split('\t'); // split/separate the columns in a row

                        select.append($("<option>")
                            .prop('value', columns[0])
                            .attr('data-sales', columns[1])
                            .text(columns[0]));

                    });


                });


        });

        $('#SaleRep').on('change', function() {
            console.log($('option:selected', this).attr('data-sales'));
            $("#sales_name").val($('option:selected', this).attr('data-sales'));

        });
    </script>

    <!-- Gobal variables -->
    <script>
        var subtype_data;
    </script>

    <script>
        var Select2Cascade2 = (function(window, $) {
            function Select2Cascade2(parent, child, select2Options) {
                var afterActions = [];
                var options = select2Options || {};

                // Register functions to be called after cascading data loading done
                this.then = function(callback) {
                    afterActions.push(callback);
                    return this;
                };

                parent.select2(select2Options).on("change", function(e) {
                    child.prop("disabled", true);
                    var newOptions = '<option value="">-- Select --</option>';
                    var cat = this.value;
                    console.log(subtype_data);
                    var filteredArray = subtype_data.filter(function(itm) {
                        return itm.CatID == cat;
                    });

                    filteredArray.forEach(function(item, index) {
                        newOptions +=
                            '<option value="' + item["SubCat"] + '">' + item["SubCat"] + "</option>";
                    })

                    child
                        .select2("destroy")
                        .html(newOptions)
                        .prop("disabled", false)
                        .select2(options);

                });
            }

            return Select2Cascade2;
        })(window, $);
    </script>

    <!-- Load file -->
    <script>
        function csvToArray(str, delimiter = ",") {
            // slice from start of text to the first \n index
            // use split to create an array from string by delimiter
            const headers = str.slice(0, str.indexOf("\r")).split(delimiter);

            // slice from \n index + 1 to the end of the text
            // use split to create an array of each csv value row
            const rows = str.slice(str.indexOf("\n") + 1).split(/\r?\n|\r/);

            // Map the rows
            // split values from each row into an array
            // use headers.reduce to create an object
            // object properties derived from headers:values
            // the object passed as an element of the array
            const arr = rows.map(function(row) {
                const values = row.split(delimiter);
                const el = headers.reduce(function(object, header, index) {
                    object[header] = values[index];
                    return object;
                }, {});
                return el;
            });

            // return the array
            return arr;
        }
        $(document).ready(function() {

            $('#SaleRep').select2({
                // placeholder: 'Select an option',
                width: '100px'
            });

            fetch('ajax/data/pd_cat.txt')
                .then(function(response) {
                    return response.text();
                })
                .then(function(data) {

                    var select = $("#update-form #product_category");
                    var values = data.trim().split(/\r?\n|\r/);


                    // select.append($("<option>")
                    //     .prop('value',
                    //         '')
                    //     .text('-- Select --'));

                    values.forEach(function(row, row_index) {
                        if (row_index > 0) {
                            var table_columns = '';
                            var columns = row.split('\t'); // split/separate the columns in a row
                            select.append($("<option>")
                                .prop('value', columns[0])
                                .text(columns[0] + ' : ' + columns[1]));
                        }
                    });
                });

            fetch('ajax/data/pd_subcat.txt')
                .then(function(response) {
                    return response.text();
                })
                .then(function(data) {

                    var select = $("#update-form #product_code");
                    subtype_data = csvToArray(data.trim(), '\t');
                    //console.log(values);
                });

            var select2Options = {
                width: "resolve"
            };

            $("select").select2(select2Options);
            var cascadLoading = new Select2Cascade2(
                $("#update-form #product_category"),
                $("#update-form #product_code"),
                select2Options
            );

            // cascadLoading.then(function (parent, child, items) {
            //   // Dump response data
            //   console.log(items);
            // });

        });
    </script>

    <!-- DataTables  & Plugins -->
    <!-- <script src="plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
    <script src="plugins/jszip/jszip.min.js"></script>
    <script src="plugins/pdfmake/pdfmake.min.js"></script>
    <script src="plugins/pdfmake/vfs_fonts.js"></script>
    <script src="plugins/datatables-buttons/js/buttons.html5.min.js"></script>
    <script src="plugins/datatables-buttons/js/buttons.print.min.js"></script>
    <script src="plugins/datatables-buttons/js/buttons.colVis.min.js"></script> -->


    </html>